 SUBROUTINE modps6(matty,d,c,b,sf)
 IMPLICIT NONE
 INTEGER(kind=4) :: matty
 REAL(kind=8) :: d(8,8),c(15),b(21),sf(3)

 IF(matty <= 4) d = 0d0
 SELECT CASE (matty)
 CASE (1:2)
   d(1,1) = c(1)
   d(2,1) = c(2)
   d(2,2) = c(1)
   d(3,3) = c(3)
   d(4,4) = c(4)
   d(5,4) = c(5)
   d(5,5) = c(4)
   d(6,6) = c(6)
   d(7,7) = c(7)
   d(8,8) = c(7)
 CASE (3)
   d(1,1) = c(1)
   d(2,1) = c(2)
   d(2,2) = c(3)
   d(3,3) = c(4)
   d(4,4) = c(5)
   d(5,4) = c(6)
   d(5,5) = c(7)
   d(6,6) = c(8)
   d(7,7) = c(9)
   d(8,8) = c(10)
 CASE (4,5)
   d(1,1) = c(1)
   d(2,1) = c(2)
   d(3,1) = c(3)
   d(2,2) = c(4)
   d(3,2) = c(5)
   d(3,3) = c(6)
   d(4,4) = c(7)
   d(5,4) = c(8)
   d(6,4) = c(9)
   d(5,5) = c(10)
   d(6,5) = c(11)
   d(6,6) = c(12)
   d(7,7) = c(13)
   d(8,7) = c(14)
   d(8,8) = c(15)
   IF( matty == 5 )THEN
     d(4,1) = b(1)          !coupling terms
     d(5,1) = b(2)
     d(6,1) = b(3)
     !d(7,1) = b(10)
     !d(8,1) = b(11)
     d(4,2) = b(4)
     d(5,2) = b(5)
     d(6,2) = b(6)
     !d(7,2) = b(12)
     !d(8,2) = b(13)
     d(4,3) = b(7)
     d(5,3) = b(8)
     d(6,3) = b(9)
     d(7,7) = d(7,7) *sf(1)
     d(8,7) = d(8,7) *sf(2)
     d(8,8) = d(8,8) *sf(3)
     !d(7,3) = b(14)
     !d(8,3) = b(15)
     !d(7,4) = b(16)
     !d(8,4) = b(17)
     !d(7,5) = b(18)
     !d(8,5) = b(19)
     !d(7,6) = b(20)
     !d(8,6) = b(21)
   END IF
 END SELECT
 RETURN
 END SUBROUTINE modps6
